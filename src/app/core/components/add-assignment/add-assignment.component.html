@if (isPositionSelected) {
  <div>
    <h4 class="card-title">Position {{(positionToAssign$ | async).positionName}}</h4>
    @if (isSuborganizationSelected) {
      <div>
        <h4 class="card-description">In suborganization {{selectedSuborganization.commonName}}</h4>
        <div>
          <button class="btn btn-warning"
            (click)="showQuickSearch()">
            <i class="material-icons">search</i>
            Quick Search
          </button>
          <button class="btn btn-warning"
            (click)="showAdvancedSearch()">
            <i class="material-icons">youtube_searched_for</i>
            Advanced Search
          </button>
          <button class="btn btn-warning"
            (click)="showAddCitizen()">
            <i class="material-icons">person_add</i>
            Add Citizen
          </button>
          @if (isQuickSearching) {
            @defer (on interaction) {
              <app-quick-search
                (onSearch)="quickSearch($event)">
              </app-quick-search>
            } @placeholder {
              <div class="loading-placeholder">
                <i class="material-icons">search</i>
                <span>Loading Quick Search...</span>
              </div>
            }
          }
          @if (isAdvancedSearching) {
            @defer (on interaction) {
              <app-advanced-search
                (onSearch)="advancedSearch($event)">
              </app-advanced-search>
            } @placeholder {
              <div class="loading-placeholder">
                <i class="material-icons">youtube_searched_for</i>
                <span>Loading Advanced Search...</span>
              </div>
            }
          }
          @if (isAddingCitizen) {
            @defer (on interaction) {
              <app-citizen-form
                [isUpdating]="false"
                (onChange)="addCitizen($event)" >
              </app-citizen-form>
            } @placeholder {
              <div class="loading-placeholder">
                <i class="material-icons">person_add</i>
                <span>Loading Citizen Form...</span>
              </div>
            }
          }
        </div>
        @if (isSelecting) {
          @defer (on viewport) {
            <app-citizen-selection-list
              [searchResults]="citizenSearchResults"
              (onSelect)="selectCitizen($event)">
            </app-citizen-selection-list>
          } @placeholder {
            <div class="loading-placeholder">
              <i class="material-icons">list</i>
              <span>Loading Citizen Selection...</span>
            </div>
          }
        }
        @if (isAssigning) {
          @defer (on interaction) {
            <app-assignment-form
              [suborganization]="selectedSuborganization"
              [positionToFill]="selectedPosition"
              [initCitizen]="initCitizen"
              (onAssign)="assignPosition($event)">
            </app-assignment-form>
          } @placeholder {
            <div class="loading-placeholder">
              <i class="material-icons">assignment</i>
              <span>Loading Assignment Form...</span>
            </div>
          }
        }
      </div>
    }
  </div>
}
